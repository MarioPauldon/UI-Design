{% extends "layout.html" %}

{% block content %}
<h2>Edit Company Details</h2>

<!-- Flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<!-- Edit Form -->
<form action="{{ url_for('edit_company', company_id=company.id) }}" method="POST" class="mt-4">
    <div class="mb-3">
        <label for="company" class="form-label">Company Name</label>
        <input type="text" class="form-control" id="company" name="company" value="{{ company.company }}" required>
    </div>

    <div class="mb-3">
        <label for="ticker" class="form-label">Ticker Symbol</label>
        <input type="text" class="form-control" id="ticker" name="ticker" value="{{ company.ticker }}" required>
    </div>

    <div class="mb-3">
        <label for="sector" class="form-label">Sector</label>
        <input type="text" class="form-control" id="sector" name="sector" value="{{ company.sector }}" required>
    </div>

    <div class="mb-3">
        <label for="market_cap" class="form-label">Market Cap</label>
        <input type="text" class="form-control" id="market_cap" name="market_cap" value="{{ company.market_cap }}" required>
    </div>

    <div class="mb-3">
        <label for="stock_price" class="form-label">Stock Price</label>
        <input type="text" class="form-control" id="stock_price" name="stock_price" value="{{ company.stock_price }}" required>
    </div>

    <div class="mb-3">
        <label for="revenue" class="form-label">Revenue</label>
        <input type="text" class="form-control" id="revenue" name="revenue" value="{{ company.revenue }}" required>
    </div>

    <div class="mb-3">
        <label for="pe_ratio" class="form-label">P/E Ratio</label>
        <input type="text" class="form-control" id="pe_ratio" name="pe_ratio" value="{{ company.pe_ratio }}" required>
    </div>

    <div class="mb-3">
        <label for="dividend_yield" class="form-label">Dividend Yield</label>
        <input type="text" class="form-control" id="dividend_yield" name="dividend_yield" value="{{ company.dividend_yield }}" required>
    </div>

    <div class="mb-3">
        <label for="image" class="form-label">Image URL</label>
        <input type="text" class="form-control" id="image" name="image" value="{{ company.image }}" required>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
    <button type="button" class="btn btn-danger" onclick="confirmDiscard()">Discard Changes</button>
</form>

<script>
function confirmDiscard() {
    let confirmation = confirm("Are you sure you want to discard changes? Your edits will not be saved.");
    if (confirmation) {
        window.location.href = "{{ url_for('company_page', company_id=company.id) }}";
    }
}
</script>

{% endblock %}
